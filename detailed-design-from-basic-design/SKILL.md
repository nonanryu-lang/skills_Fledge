---
name: detailed-design-from-basic-design
description: 基本設計書をもとにWebアプリケーション開発の詳細設計書を作成・更新するスキル。機能単位の処理フロー、I/O、バリデーション、エラー処理、DB詳細、API入出力、テスト観点まで落とし込みたいときに使用する。次の場面で使う：(1) 基本設計完了後に実装可能な粒度へ詳細化したいとき、(2) 既存詳細設計へ基本設計変更を差分反映したいとき、(3) 実装者・テスト担当へ引き継ぐ設計ドキュメントを整備したいとき、(4) 「詳細設計書」「内部設計」「処理詳細」「ロジック設計」「基本設計から詳細化」などのキーワードがあるとき。
---

# 基本設計→詳細設計書作成スキル

基本設計書（画面/API/データ/非機能）を入力として、実装・テストに直結する詳細設計書を作成する。

## ワークフロー判定

入力状態に応じてフローを選ぶ：

- **新規作成フロー**: 基本設計書はあるが詳細設計書が未作成
- **差分更新フロー**: 既存詳細設計書に対して基本設計変更を反映

## ステップ1: 入力資料と設計境界を確認する

最初に次を確認する：

1. 入力資料の種類（基本設計書、変更要求、制約一覧、運用要件）
2. 対象範囲（対象機能、対象画面、対象API、対象リリース）
3. 詳細化レベル（実装疑似コードまで含むか、設計仕様までか）
4. 出力粒度（機能単位、画面単位、サービス単位）

不足がある場合は2〜3問ずつ追加ヒアリングする。

## ステップ2: 基本設計を詳細設計要素へマッピングする

基本設計の各要素を詳細設計へ分解する。マッピング基準は [references/basic-to-detailed-mapping.md](references/basic-to-detailed-mapping.md) を参照する。

- 画面設計 → 画面イベント、入力チェック、表示制御、エラー表示
- API設計 → リクエスト検証、ユースケース手順、例外ハンドリング、レスポンス組み立て
- データ設計 → テーブル操作順、トランザクション境界、ロック/整合性、監査項目
- 非機能設計 → タイムアウト、リトライ、監視イベント、ログ粒度、セキュリティ制御

## ステップ3: 詳細設計書を作成する

テンプレートは [references/detailed-design-template.md](references/detailed-design-template.md) を使う。

作成時のルール：

1. 機能ごとに「前提・入力・処理手順・例外・出力・テスト観点」を1セットで記述する
2. 基本設計IDと詳細設計IDを紐づける（例: `SCR-03` → `DD-SCR-03-01`）
3. 分岐・繰り返し・排他制御は擬似コードまたは条件表で明示する
4. 未確定事項は `[TBD]` とし、影響範囲と確認先を併記する
5. 出力ファイル名は `detailed-design-[プロジェクト名].md` とする

## ステップ4: 実装可能性とテスト可能性を検証する

最低限、次を確認する：

1. 詳細設計だけで主要処理を実装できる（曖昧な仕様が残っていない）
2. 入力異常・業務例外・外部障害時の挙動が定義されている
3. DB更新処理に整合性リスク（更新順、同時更新、ロールバック漏れ）がない
4. テスト観点が正常系/準正常系/異常系を網羅している
5. 非機能要件（性能・可用性・セキュリティ・監査）を処理仕様に落とし込んでいる

不足があれば「不足詳細設計項目」として列挙し、追補案を提示する。

## ステップ5: 差分更新時の反映手順を実行する

差分更新フローでは次を実行する：

1. 変更された基本設計項目を特定する（追加/変更/削除）
2. 影響する詳細設計セクションを抽出する（画面/API/データ/非機能）
3. 該当セクションを更新し、変更履歴に理由と影響範囲を記録する
4. 関連テスト観点を同時更新する
5. 影響が大きい変更は代替案とトレードオフを併記する

## ステップ6: レビューして確定する

ユーザーへ以下を確認する：

1. 実装チームが最優先で必要とするセクション（画面/API/バッチ/データ）
2. `[TBD]` の決定担当者と期限
3. 次工程（実装、単体テスト、結合テスト）への受け渡し形式

レビュー反映後、最終版を出力する。
